---
title: "Final Project"
output: html_document
date: "2023-11-30"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
library(gplots)
library(maps) 
library(dplyr)  
library(ggmap)
library(lubridate)
library(ggthemes)
library(RColorBrewer) 
library(sf)

```

```{r}

load('LAPOP.rda')
LAPOP <- da36562.0001
rm(da36562.0001)

```

```{r}
SouthAmerica <- LAPOP %>% 
  filter(PAIS %in% c("(17) Argentina", "(10) Bolivia", "(08) Colombia", "(15) Brazil", "(12) Paraguay", "(14) Uruguay", "(11) Peru", "(13) Chile", "(09) Ecuador", "(16) Venezuela", "(27) Suriname")) %>% 
  mutate(PAIS = substr(PAIS, 6, 20))

```

```{r}
#HUMAN RIGHTS 

SouthAmericaB3 <- SouthAmerica %>% 
  select(YEAR, PAIS, B3) %>% 
  drop_na() %>% 
  group_by(PAIS) %>% 
  summarise(averageB3 = mean(B3))

SouthAmericasf <- read_sf("vc965bq8111") %>%
  group_by(name) %>%
  summarise(geometry = st_combine(geometry)) %>%
  mutate(name = stringr::str_to_lower(name))
  

SouthAmericasf %>% left_join(SouthAmericaB3 %>% mutate(PAIS = stringr::str_to_lower(PAIS)),by = c('name' = 'PAIS')) %>% 
  ggplot() +
  geom_sf(aes(fill = averageB3))--

```
```{r}
# life satisfaction 

SouthAmericaLS3 <- SouthAmerica %>% 
  select(YEAR, PAIS, LS3) %>% 
  drop_na() %>% 
  group_by(PAIS) %>% 
  summarise(averageLS3 = mean(LS3))

SouthAmericasf <- read_sf("vc965bq8111") %>%
  group_by(name) %>%
  summarise(geometry = st_combine(geometry)) %>%
  mutate(name = stringr::str_to_lower(name))
  

SouthAmericasf %>% left_join(SouthAmericaLS3 %>% mutate(PAIS = stringr::str_to_lower(PAIS)),by = c('name' = 'PAIS')) %>% 
  ggplot() +
  geom_sf(aes(fill = averageLS3))--
```

```{r}
SouthAmericaDEM2 <- SouthAmerica %>% 
  select(YEAR, PAIS, DEM2) %>% 
  drop_na() %>% 
  group_by(PAIS) %>% 
  mutate(total_resp_country = n()) %>% 
  mutate(answer2_country = ) ## finish this line
  mutate(perctent_DEM2 = )
```

