#trying to show change over time in answers :)
# Life satisfaction
LS3_over_time <- SouthAmerica %>%
select(YEAR, PAIS, LS3) %>%
drop_na() %>%
group_by(PAIS, YEAR) %>%
mutate(LS3num = fct_recode(LS3, "1" = "(1) Very Satisfied", "2" = "(2) Somewhat Satisfied", "3" = "(3) Somewhat Dissatisfied", "4" = "(4) Very Dissatisfied")) %>%
mutate(total_ls3 = n()) %>%
filter(LS3num == "1") %>%
mutate(total_good_ls3 = n()) %>%
distinct(PAIS, YEAR, .keep_all = TRUE) %>%
mutate(percent_good_ls3 = 100 * total_good_ls3 / total_ls3) %>%
select(PAIS, YEAR, percent_good_ls3, total_good_ls3, total_ls3)
LS3_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_ls3)) +
geom_point() +
facet_wrap(~ PAIS)
LS3_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_ls3, color=PAIS)) +
geom_point()
# Gov protects basic rights
B3_over_time <- SouthAmerica %>%
select(YEAR, PAIS, B3) %>%
drop_na() %>%
group_by(PAIS, YEAR) %>%
mutate(total_b3 = n()) %>%
filter(B3 >= 5) %>%
mutate(total_good_b3 = n()) %>%
distinct(PAIS, YEAR, .keep_all = TRUE) %>%
mutate(percent_good_b3 = 100 * total_good_b3 / total_b3) %>%
select(PAIS, YEAR, percent_good_b3, total_good_b3, total_b3)
B3_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_b3)) +
geom_point() +
facet_wrap(~ PAIS)
B3_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_b3, color=PAIS)) +
geom_point()
# Democracy
DEM2_over_time <- SouthAmerica %>%
select(YEAR, PAIS, DEM2) %>%
drop_na() %>%
group_by(PAIS, YEAR) %>%
mutate(total_dem2 = n()) %>%
filter(DEM2 == "(2) Democracy is preferable to any other form of government") %>%
mutate(total_good_dem2 = n()) %>%
distinct(PAIS, YEAR, .keep_all = TRUE) %>%
mutate(percent_good_dem2 = 100 * total_good_dem2 / total_dem2) %>%
select(PAIS, YEAR, percent_good_dem2, total_good_dem2, total_dem2)
DEM2_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_dem2)) +
geom_point() +
facet_wrap(~ PAIS)
DEM2_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_dem2, color=PAIS)) +
geom_point()
#Economic situation
SOCT1_over_time <- SouthAmerica %>%
select(YEAR, PAIS, SOCT1) %>%
drop_na() %>%
group_by(PAIS, YEAR) %>%
mutate(total_soct1 = n()) %>%
filter(SOCT1 %in% c("(2) Good", "(1) Very Good")) %>%
mutate(total_good_soct1 = n()) %>%
distinct(PAIS, YEAR, .keep_all = TRUE) %>%
mutate(percent_good_soct1 = 100 * total_good_soct1 / total_soct1) %>%
select(PAIS, YEAR, percent_good_soct1, total_good_soct1, total_soct1)
SOCT1_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_soct1)) +
geom_point() +
facet_wrap(~ PAIS)
SOCT1_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_soct1, color=PAIS)) +
geom_point()
questions_over_time <- left_join(LS3_over_time, B3_over_time)
questions_over_time <- left_join(questions_over_time, DEM2_over_time)
questions_over_time <- left_join(questions_over_time, SOCT1_over_time)
questions_over_time %>%
ggplot(aes(x=percent_good_ls3, y=percent_good_dem2, color=PAIS)) +
geom_point() +
facet_wrap(~ YEAR)
questions_over_time <- questions_over_time %>%
mutate(YearCat = cut(YEAR, c(2004,2009,2015), right = FALSE, labels = c('2004-08','2009-14')))
# first hald decade
questions_over_time %>%
filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_dem2, color=YEAR)) +
geom_text(aes(label =PAIS))
questions_over_time %>%
filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_soct1, color=YEAR)) +
geom_text(aes(label =PAIS))
questions_over_time %>%
filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=YEAR)) +
geom_text(aes(label =PAIS))
# second half decade
questions_over_time %>%
filter(YearCat == "2009-14") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_dem2, color=YEAR)) +
geom_text(aes(label =PAIS))
questions_over_time %>%
filter(YearCat == "2009-14") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_soct1, color=YEAR)) +
geom_text(aes(label =PAIS))
questions_over_time %>%
filter(YearCat == "2009-14") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=YEAR)) +
geom_text(aes(label =PAIS))
#pivot longer:
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=`Percent Good`, fill =Question)) +
geom_density() +
facet_grid(~YearCat)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Bolivia") %>%
ggplot(aes(x=`Percent Good`, fill =Question)) +
geom_density() +
facet_grid(~YearCat)
#VENEZUELA
questions_over_time %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(y=percent_good_ls3, x=YEAR, color=percent_good_dem2)) +
geom_text(aes(label =PAIS))
questions_over_time %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(y=percent_good_ls3, x=YEAR, color=percent_good_soct1)) +
geom_text(aes(label =PAIS))
questions_over_time %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(y=percent_good_ls3, x=YEAR, color=percent_good_b3)) +
geom_text(aes(label =PAIS))
`
questions_over_time %>%
filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=YEAR)) +
geom_text(aes(label =PAIS)) + facet_grid(~YEAR)
questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=YEAR)) +
geom_text(aes(label =PAIS)) + facet_grid(~YEAR)
questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=YEAR)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 30) +
geom_vline(xintercept = 20) + theme_classic()+ facet_grid(~YEAR)
questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=YEAR)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 40) + theme_classic()+ facet_grid(~YEAR)
questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=YEAR)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 35) + theme_classic()+ facet_grid(~YEAR)
install.packages('gganimate')
library(gganimate)
pp_anim <- questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 35) + theme_classic() + transition_states(YEAR)
install.packages('av')
pp_anim <- questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 35) + theme_classic() + transition_states(YEAR)
pp_anim
pp_anim
animate(pp_anim, fps = 1,renderer = av_renderer())
?animate
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
LS3_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_ls3)) +
geom_point() +
facet_wrap(~ PAIS)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=YEAR, y=`Percent Good`)) +
geom_point() + facet_grid(~Question)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=YEAR, y=`Percent Good`)) +
geom_point() + facet_grid(~Question)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Bolivia") %>%
ggplot(aes(x=YEAR, y=`Percent Good`)) +
geom_point() + facet_grid(~Question)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=YEAR, y=`Percent Good`, color=Question)) +
geom_point() + geom_line()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(gplots)
library(maps)
library(dplyr)
library(ggmap)
library(lubridate)
library(ggthemes)
library(RColorBrewer)
library(sf)
#trying to show change over time in answers :)
# Life satisfaction
LS3_over_time <- SouthAmerica %>%
select(YEAR, PAIS, LS3) %>%
drop_na() %>%
group_by(PAIS, YEAR) %>%
mutate(LS3num = fct_recode(LS3, "1" = "(1) Very Satisfied", "2" = "(2) Somewhat Satisfied", "3" = "(3) Somewhat Dissatisfied", "4" = "(4) Very Dissatisfied")) %>%
mutate(total_ls3 = n()) %>%
filter(LS3num == "1") %>%
mutate(total_good_ls3 = n()) %>%
distinct(PAIS, YEAR, .keep_all = TRUE) %>%
mutate(percent_good_ls3 = 100 * total_good_ls3 / total_ls3) %>%
select(PAIS, YEAR, percent_good_ls3, total_good_ls3, total_ls3)
LS3_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_ls3)) +
geom_point() +
facet_wrap(~ PAIS)
LS3_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_ls3, color=PAIS)) +
geom_point()
# Gov protects basic rights
B3_over_time <- SouthAmerica %>%
select(YEAR, PAIS, B3) %>%
drop_na() %>%
group_by(PAIS, YEAR) %>%
mutate(total_b3 = n()) %>%
filter(B3 >= 5) %>%
mutate(total_good_b3 = n()) %>%
distinct(PAIS, YEAR, .keep_all = TRUE) %>%
mutate(percent_good_b3 = 100 * total_good_b3 / total_b3) %>%
select(PAIS, YEAR, percent_good_b3, total_good_b3, total_b3)
B3_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_b3)) +
geom_point() +
facet_wrap(~ PAIS)
B3_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_b3, color=PAIS)) +
geom_point()
# Democracy
DEM2_over_time <- SouthAmerica %>%
select(YEAR, PAIS, DEM2) %>%
drop_na() %>%
group_by(PAIS, YEAR) %>%
mutate(total_dem2 = n()) %>%
filter(DEM2 == "(2) Democracy is preferable to any other form of government") %>%
mutate(total_good_dem2 = n()) %>%
distinct(PAIS, YEAR, .keep_all = TRUE) %>%
mutate(percent_good_dem2 = 100 * total_good_dem2 / total_dem2) %>%
select(PAIS, YEAR, percent_good_dem2, total_good_dem2, total_dem2)
DEM2_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_dem2)) +
geom_point() +
facet_wrap(~ PAIS)
DEM2_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_dem2, color=PAIS)) +
geom_point()
#Economic situation
SOCT1_over_time <- SouthAmerica %>%
select(YEAR, PAIS, SOCT1) %>%
drop_na() %>%
group_by(PAIS, YEAR) %>%
mutate(total_soct1 = n()) %>%
filter(SOCT1 %in% c("(2) Good", "(1) Very Good")) %>%
mutate(total_good_soct1 = n()) %>%
distinct(PAIS, YEAR, .keep_all = TRUE) %>%
mutate(percent_good_soct1 = 100 * total_good_soct1 / total_soct1) %>%
select(PAIS, YEAR, percent_good_soct1, total_good_soct1, total_soct1)
SOCT1_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_soct1)) +
geom_point() +
facet_wrap(~ PAIS)
SOCT1_over_time %>%
ggplot(aes(x=YEAR, y=percent_good_soct1, color=PAIS)) +
geom_point()
# new data set: all 4 questions over time and visuals
questions_over_time <- left_join(LS3_over_time, B3_over_time)
questions_over_time <- left_join(questions_over_time, DEM2_over_time)
questions_over_time <- left_join(questions_over_time, SOCT1_over_time)
questions_over_time %>%
ggplot(aes(x=percent_good_ls3, y=percent_good_dem2, color=PAIS)) +
geom_point() +
facet_wrap(~ YEAR)
questions_over_time <- questions_over_time %>%
mutate(YearCat = cut(YEAR, c(2004,2009,2015), right = FALSE, labels = c('2004-08','2009-14')))
# first half decade
questions_over_time %>%
filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_dem2, color=YEAR)) +
geom_text(aes(label =PAIS))
questions_over_time %>%
filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_soct1, color=YEAR)) +
geom_text(aes(label =PAIS))
# animated basic rights and life satisfaction over time for all countries!
library(gganimate)
pp_anim <- questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 35) + theme_classic() + transition_states(YEAR)
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
#if we do this for one country (case study): add geom_path to shwo the journey
# second half decade
questions_over_time %>%
filter(YearCat == "2009-14") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_dem2, color=YEAR)) +
geom_text(aes(label =PAIS))
questions_over_time %>%
filter(YearCat == "2009-14") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_soct1, color=YEAR)) +
geom_text(aes(label =PAIS))
questions_over_time %>%
filter(YearCat == "2009-14") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=YEAR)) +
geom_text(aes(label =PAIS))
#pivot longer:
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=`Percent Good`, fill =Question)) +
geom_density() +
facet_grid(~YearCat)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Bolivia") %>%
ggplot(aes(x=`Percent Good`, fill =Question)) +
geom_density() +
facet_grid(~YearCat)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=YEAR, y=`Percent Good`)) +
geom_point() + facet_grid(~Question)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Bolivia") %>%
ggplot(aes(x=YEAR, y=`Percent Good`)) +
geom_point() + facet_grid(~Question)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=YEAR, y=`Percent Good`, color=Question)) +
geom_point() + geom_line()
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=YEAR, y=`Percent Good`, color=Question)) +
geom_point() + geom_line()
library(gganimate)
pp_anim <- questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 35) + theme_classic() + transition_states(YEAR)
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
library(gganimate)
pp_anim <- questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_dem2, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 35) + theme_classic() + transition_states(YEAR)
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
library(gganimate)
pp_anim <- questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_dem2, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 50) + theme_classic() + transition_states(YEAR)
library(gganimate)
pp_anim <- questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_dem2, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 50) + theme_classic() + transition_states(YEAR)
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
library(gganimate)
pp_anim <- questions_over_time %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_dem2, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 50) + theme_classic() + transition_states(YEAR)
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
pp_anim <- questions_over_time %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_dem2, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 50) + theme_classic() + transition_states(YEAR)
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
pp_anim <- questions_over_time %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_soct1, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 50) + theme_classic() + transition_states(YEAR)
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=YEAR, y=`Percent Good`)) +
geom_point() + facet_grid(~Question)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Bolivia") %>%
ggplot(aes(x=YEAR, y=`Percent Good`)) +
geom_point() + facet_grid(~Question)
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=YEAR, y=`Percent Good`, color=Question)) +
geom_point() + geom_line()
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Venezuela") %>%
ggplot(aes(x=YEAR, y=`Percent Good`, color=Question)) +
geom_point() + geom_line()
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Bolivia") %>%
ggplot(aes(x=YEAR, y=`Percent Good`, color=Question)) +
geom_point() + geom_line()
questions_over_time %>%
select(YEAR, PAIS, percent_good_ls3, percent_good_b3, percent_good_dem2, percent_good_soct1, YearCat) %>%
pivot_longer(3:6, names_to = "Question", values_to = "Percent Good", values_drop_na = FALSE) %>%
filter(PAIS == "Colombia") %>%
ggplot(aes(x=YEAR, y=`Percent Good`, color=Question)) +
geom_point() + geom_line()
# LIFE SATISFACTION (In general how satisfied are you with your life?) (1 = very satisfied, 4 = very dissatisfied)
SouthAmericaLS3 <- SouthAmerica %>%
select(YEAR, PAIS, LS3) %>%
drop_na() %>%
group_by(PAIS) %>%
mutate(LS3num = fct_recode(LS3, "1" = "(1) Very Satisfied", "2" = "(2) Somewhat Satisfied", "3" = "(3) Somewhat Dissatisfied", "4" = "(4) Very Dissatisfied")) %>%
mutate(total_resp_country = n()) %>%
filter(LS3num == "1") %>%
mutate(total_positive_resp = n()) %>%
distinct(PAIS, .keep_all = TRUE) %>%
mutate(percent_good_ls3 = 100 * total_positive_resp / total_resp_country)
SouthAmericasf <- read_sf("vc965bq8111") %>%
group_by(name) %>%
summarise(geometry = st_combine(geometry)) %>%
mutate(name = stringr::str_to_lower(name))
(SouthAmericasf %>% left_join(SouthAmericaLS3 %>% mutate(PAIS = stringr::str_to_lower(PAIS)),by = c('name' = 'PAIS')) %>%
ggplot() +
theme_map() +
theme(legend.background = element_blank()) +
theme(legend.position = "right") +
geom_sf(aes(fill = percent_good_ls3))) %>% plotly::ggplotly()
SouthAmericaLS3 %>%
arrange(percent_good_ls3)
# animated basic rights and life satisfaction over time for all countries!
library(gganimate)
pp_anim <- questions_over_time %>%
#filter(YearCat == "2004-08") %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_b3, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 35) + theme_classic() + transition_states(YEAR)
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
# animated dem2 and life satisfaction over time for all countries!
library(gganimate)
pp_anim <- questions_over_time %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_dem2, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 50) + theme_classic() + transition_states(YEAR)
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
# animated soct1 and life satisfaction over time for all countries!
library(gganimate)
pp_anim <- questions_over_time %>%
ggplot(aes(y=percent_good_ls3, x=percent_good_soct1, color=PAIS)) +
geom_text(aes(label =PAIS)) +
geom_hline(yintercept = 40) +
geom_vline(xintercept = 50) + theme_classic() + transition_states(YEAR)
animate(pp_anim, nframes = 20, fps = 1,renderer = av_renderer())
